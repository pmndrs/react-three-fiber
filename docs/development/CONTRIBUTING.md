## Contributing

This project uses [semantic commits](https://conventionalcommits.org) and [semver](https://semver.org).

To get started, make sure you have [Node](https://nodejs.org) (v18+) and [Yarn](https://yarnpkg.com) (v4+) installed. Install dependencies with:

```bash
yarn install
```

This will automatically run `yarn stub` to create development stubs that point to source code, allowing you to develop without rebuilding. See [BUILD](./docs/BUILD.md) for details on our build system.

If you ever need to manually regenerate stubs, run:

```bash
yarn dev
```

> **Note**: Some Windows users may need to [enable developer mode](https://howtogeek.com/292914/what-is-developer-mode-in-windows-10) if experiencing `EPERM: operation not permitted, symlink` with stub generation. If this persists, you might be running on an unsupported drive/format. In which case, consider using [Docker](https://docs.docker.com/docker-for-windows).

### Development

Locally run examples against the library with:

```bash
yarn examples
```

### Testing

Run test suites against the library with:

```bash
yarn test

# or, to test live against changes
yarn test:watch
```

If your code invalidates a snapshot, you can update it with:

```bash
yarn test -u
```

> **Note**: Use discretion when updating snapshots, as they represent the integrity of the package.
>
> If the difference is complex or you're unsure of the changes, leave it for review and we'll unblock it.

### Publishing

We use [atlassian/changesets](https://github.com/atlassian/changesets) to publish our packages, which will automatically document and version changes.

To publish a release on NPM, run the following and complete the dialog (see [FAQ](https://github.com/changesets/changesets/blob/main/docs/common-questions.md)):

```bash
# Describe the changes you've made as you would semantic commits for CHANGELOG.md
yarn changeset:add

# Tag which packages should receive an update and be published.
yarn vers

# Commit and publish changes to NPM.
yarn release
```

We don't have automatic CI deployments yet, so make sure to [create a release](https://github.com/pmndrs/react-three-fiber/releases/new) on GitHub to notify people when it's ready. Choose or create the version generated by your changeset, and you can leave the rest to auto-fill via the "Generate release notes" button to describe PRs since the last release.

### Prerelease

Follow the same steps as before, but specify a tag for [prerelease mode](https://github.com/changesets/changesets/blob/main/docs/prereleases.md) with:

```bash
yarn changeset pre enter <alpha | beta | rc>
```

To cancel or leave prerelease mode, try running:

```bash
yarn changeset pre exit
```
